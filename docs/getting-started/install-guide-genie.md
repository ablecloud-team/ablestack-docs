# ABLESTACK Genie 구성진행

!!! danger
    이 문서는 기술지원 용도의 문서입니다. 기술지원 엔지니어가 아닌 사용자가 조작할 때 시스템에 문제가 발생할 수 있습니다.

ABLESTACK Genie 설치 진행 가이드 입니다.
ABLESTACK Mold 의 **오토메이션** 을 이용하여 진행이 되며 **오토메이션** 메뉴는 **Mold > 구성 > 글로벌 설정** 에서 **cloud.automation.service.enabled** 항목을 **true** 로 값을 변경 하고 ABLESTACK Mold 를 재시작 하면 **오토메이션** 메뉴가 활성화 됩니다.

## Mold 에서의 오토메이션 서비스 배포

### Mold 글로벌 설정 변경

![Genie 글로벌 설정 변경전](../assets/images/install-guide-genie-01.png){ .imgCenter .imgBorder }

- 구성 > 글로벌 설정 화면에서 **cloud.automation.service.enabled** 검색하여나오는 항목의 값을 false 에서 true 로 변경합니다.

![Genie 글로벌 설정 변경전](../assets/images/install-guide-genie-01-01.png){ .imgCenter .imgBorder }

- 상기 글로벌 설정을 적용하기 위해 ABLECLOUD Mold의 관리 서비스를 재시작해야 합니다. 이를 위해 ABLESTACK Cube의 Cockpit에 접속합니다. "ABLESTACK 플러그인 > 클라우드센터 가상머신 상태 드롭다운 메뉴 > Mold 서비스 제어"를 순서대로 클릭합니다.

![Genie 글로벌 설정 변경전](../assets/images/install-guide-genie-01-02.png){ .imgCenter .imgBorder }

- 제어명령을 "재시작"으로 선택한 후 클릭하여 실행합니다.

![Genie 글로벌 설정 변경후 Mold 재시작](../assets/images/install-guide-genie-02.png){ .imgCenter .imgBorder }

- Mold의 관리 서비스가 재시작된 후, 오토메이션 서비스 메뉴가 활성화 된 것을 확인할 수 있습니다.

### 오토메이션 컨트롤러 템플릿 생성

![Genie 컨트롤러 템플릿 생성1](../assets/images/install-guide-genie-03.png){ .imgCenter .imgBorder }

![Genie 컨트롤러 템플릿 생성2](../assets/images/install-guide-genie-04.png){ .imgCenter .imgBorder }
!!! info
    오토메이션 컨트롤러 템플릿 생성은 관리자 계정으로만 가능합니다.
- **이름** 입력창에는 컨트롤러 템플릿 이름을 입력합니다.
- **설명** 입력창에는 컨트롤러 템플릿 설명을 입력합니다.
- **버전** 입력창에는 컨트롤러 템플릿 버전을 입력합니다.
- **업로드 유형** 선택창에서는 템플릿 또는 URL을 선택합니다.
    - **템플릿** 선택은 기존에 Mold 에 등록된 템플릿에서 컨트롤러 템플릿을 선택할 수 있습니다.
        - **Genie 템플릿** 선택창에서는 Mold에서 등록된 Genie용 템플릿을 선택할 수 있습니다.
    - **URL** 선택은 웹에서 컨트롤러 템플릿을 다운로드 하여 등록할 수 있습니다.
        - **Zone** 선택은 Mold 인프라스트럭쳐에서 구성된 Zone을 선택할 수 있습니다.
        - **하이퍼바이저** 선택은 Mold 인프라스트럭쳐에서 구성된 Zone의 하이퍼 바이저를 선택할 수 있습니다.
        - **형식** 등록하는 템플릿의 형식을 선택할 수 있습니다.
        - **URL** 입력창에는 Genie용 템플릿 다운로드 URL을 입력할 수 있습니다.
        - **OS 유형** 선택창은 Genie용 템플릿의 OS 타입을 선택할 수 있습니다.
            - **Other PV (64-bit)** 를 선택합니다.
- 입력 및 선택 항목을 확인 후 에 **다음** 버튼을 클릭하여 컨트롤러 템플릿을 등록합니다.

### 오토메이션 컨트롤러 배포
![Genie 오토메이션 컨트롤러 배포](../assets/images/install-guide-genie-05.png){ .imgCenter .imgBorder }
!!! info
    오토메이션 컨트롤러는 하나의 계정당 하나만 생성 가능합니다.
- **이름** 입력창에는 배포할 오토메이션 컨트롤러의 이름을 입력합니다.
- **설명** 입력창에는 배포할 오토메이션 컨트롤러의 설명을 입력합니다.
- **컨트롤러 템플릿 버전** 선택창에는 컨트롤러 템플릿 메뉴에서 등록한 템플릿을 선택합니다.
- **컴퓨트 오퍼링** 선택창에는 배포할 컨트롤러의 오퍼링을 선택합니다.
!!! important
    오토메이션 컨트롤러가 동작하기 위한 VM의 **최소 오퍼링** 은 CPU(4Core), Memory(8GB)입니다.
- **네트워크** 선택창에는 컨트롤러와 연결할 네트워크를 선택합니다.
!!! important
    오토메이션 컨트롤러 생성 시 네트워크 조건:

    - 하나의 오토메이션 컨트롤러에 한 개의 네트워크에만 할당할 수 있습니다. (여러 개의 오토메이션 컨트롤러 생성 가능)
    - 네트워크 상태는 **Allocated** 여야 합니다.
    - 오토메이션 컨트롤러는 **isolated** 네트워크로만 배포가 가능하며 해당 네트워크의 **송신 규칙** 은 제거된 상태여야 합니다.
    - 오토메이션 컨트롤러는 **Source-Nat** 방식의 Public IP에 할당되어 배포됩니다.

- **오토메이션 컨트롤러 IP** 입력창에는 오토메이션 컨트롤러의 IP를 입력합니다. 선택 사항입니다.
!!! important
    오토메이션 컨트롤러의 IP는 위에서 선택한 네트워크 선택창에서 선택한 네트워크의 **CIDR** 의 범위안에 IP를 입력해야 합니다.
    입력하지 않을 경우, IP 주소가 자동으로 할당됩니다.
- 입력 및 선택 항목을 확인 후에 **다음** 버튼을 클릭하여 오토메이션 컨트롤러 배포를 진행합니다.
!!! info
    오토메이션 컨트롤러가 생성되고 Genie 대시보드에 접속하기 위해서는 약 2분정도의 시간이 소요됩니다.

!!! warning
    오토메이션 컨트롤러의 SSH Key로 생성된 SSH 키 쌍은 `"[오토메이션_컨트롤러_이름]-genie"` 라는 이름으로 생성됩니다. 생성된 **SSH 키 쌍** 이 **삭제** 되면 오토메이션 컨트롤러가 VM을 정상적으로 배포할 수 없습니다.

!!! warning
    오토메이션 컨트롤러의 VM은 `"[오토메이션_컨트롤러_이름]-genie"` 라는 이름으로 생성되며 Mold의 "컴퓨트 -> 가상머신" 메뉴에서 확인 할 수 있습니다. 하지만 정상적 서비스 사용을 위해 정지, 삭제, 재시작 등은 "오토메이션 -> 오토메이션 컨트롤러" 메뉴를 통해 제어되어야 합니다.

다음 설치 작업을 진행합니다.
